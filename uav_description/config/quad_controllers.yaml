controller_manager:
  ros__parameters:
    update_rate: 500

    imu_sensor_broadcaster:
      type: imu_sensor_broadcaster/IMUSensorBroadcaster

    control_allocation:
      type: control_allocation/ControlAllocationSimple

    angular_velocity:
      type: uav_controllers/AngVelPID

    angular_position:
      type: uav_controllers/AngPosPID

imu_sensor_broadcaster:
  ros__parameters:
    frame_id: imu
    sensor_name: base_imu

angular_velocity:
  ros__parameters:
    mixer: control_allocation
    sensor_name: base_imu
    # https://en.wikipedia.org/wiki/Zieglerâ€“Nichols_method
    # Kp = 0.2 * Ku
    # Ki = 0.4 * Ku / Tu
    # Kd = 6/90 * Ku * Tu

    # Ku = 0.8
    # Tu = 0.012 = 1/83.33Hz = 0.012s
    gains:
      roll.p: 0.16
      pitch.p: 0.16
      roll.i: 26.66
      pitch.i: 26.66
      roll.d: 0.00064
      pitch.d: 0.00064
      yaw.p: 3.0

angular_position:
  ros__parameters:
    update_rate: 250
    velocity_controller_name: angular_velocity
    sensor_name: base_imu
    gains:
      tau: 0.2
      roll.p: 0.4
      pitch.p: 0.4
      yaw.p: 0.4
